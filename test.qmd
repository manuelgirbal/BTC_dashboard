---
title: "A bitcoin dashboard"
format:
  dashboard:
    orientation: rows
    scrolling: true
    theme: cyborg
---

```{r}
#| include: false

options(scipen=999)

library(dplyr)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)

# source("scripts/prices.R")
# source("scripts/transactions.R")
load("test.RData")

```

# Basic metrics

## Row

```{r}
#| title: "Bitcoin's daily USD price"

ggplotly(
  ggplot(btcprice, aes(date, price)) +
    geom_line(linewidth = 0.8) +
    ylab("") +
    xlab("") +
    scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
    theme(plot.background = element_rect(fill = "grey"),
          panel.background = element_rect(fill = "grey"))
)

```

```{r}
#| title: "Bitcoin's monthly transactions"

ggplotly(
  ggplot(df_txs, aes(date, txs)) +
    geom_line(linewidth = 0.8) +
    ylab("") +
    xlab("") +
    scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
    theme(plot.background = element_rect(fill = "grey"),
          panel.background = element_rect(fill = "grey"))
)

```

## Row

```{r}
#| title: "Bitcoin's average yearly USD price"

datatable(yearly,
          options = list(
            lengthChange = FALSE,
            searching = FALSE,
            paging = FALSE,
            info = FALSE,
            columnDefs = list(list(className = 'dt-center', targets = "_all")),
            initComplete = JS(
                            "function(settings, json) {",
                            "$(this.api().table().header()).css({'color': '#fff'});",
                            "}")),
          rownames = FALSE) |>
  formatPercentage("year_var") |> 
  formatCurrency("avg_price",
                 currency = "$") |>
  formatStyle(names(yearly),
              textAlign = "center",
              target = "cell")  |> 
  formatStyle("year_var",
              fontWeight = "bold",
              backgroundColor = styleInterval(c(-0.01, 0.01),
                                              c("#FFCDD2", "#d1d1d1", "#C8E6C9"))) |>
  formatStyle(c("year","avg_price"),
              backgroundColor = "#d1d1d1")


```

::: card-header
**Testeo**
:::

::: card-body
-   **Asd**: yadayada.

-   **Asd**: yadayada..
:::



